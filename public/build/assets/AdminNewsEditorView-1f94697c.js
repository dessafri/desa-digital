import{q as Q,N as W,f as d,g as X,c as C,s as Y,o as Z,O as ee,h as te,a as i,b as r,d as t,n as U,t as x,e as j,y as L,F as R,w as u,v as y,l as F,A as p,j as I,r as se,i as oe,k as v}from"./app-0010789c.js";import{c as O,J as ae,a as le}from"./jodit-11da9fd9.js";const ie={class:"space-y-8 p-8"},re={class:"flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between"},ne={class:"space-y-1.5"},de={class:"text-3xl font-semibold text-slate-900"},ue={class:"flex flex-wrap items-center gap-3"},pe=["disabled"],ce={key:0,class:"inline-flex items-center gap-2"},me={key:1},be={class:"space-y-6 rounded-3xl border border-slate-200 bg-white/95 p-6 shadow-sm backdrop-blur"},ge={key:0,class:"rounded-2xl border border-rose-100 bg-rose-50 px-4 py-3 text-xs font-semibold text-rose-600"},fe={key:0,class:"col-span-full grid place-items-center py-20"},xe={class:"space-y-6"},ye={class:"rounded-2xl border border-slate-200 bg-white p-5 shadow-sm"},ve={class:"mt-5 space-y-4 text-sm"},we={class:"space-y-1"},_e={class:"space-y-1"},ke={class:"space-y-1"},he={class:"rounded-2xl border border-slate-200 bg-white p-5 shadow-sm"},Ce={class:"mt-4 space-y-4 text-sm"},Ue={class:"space-y-6"},je={class:"rounded-2xl border border-slate-200 bg-white p-5 shadow-sm"},Ve={class:"mt-5 space-y-4 text-sm"},Be={class:"space-y-2"},Se=["value"],Te={class:"flex flex-wrap items-center gap-2 pt-2"},Me=["onKeyup"],De=["disabled"],Ne={key:0,class:"text-[11px] font-semibold text-slate-400"},Pe={class:"space-y-1"},Je={key:0,class:"space-y-1"},Ee={class:"space-y-1"},Ke="undo,redo,|,bold,italic,underline,|,ul,ol,|,link,unlink",Ie={__name:"AdminNewsEditorView",setup(Le){const V=ae,B=le,A=O({minHeight:420}),G=O({minHeight:200,buttons:Ke}),S=Q(),H=W(),w=d([]),c=d(!1),m=d(!1),_=d(""),b=d(""),k=d(!1),n=d("");let g;const s=X({id:null,news_category_id:"",title:"",slug:"",excerpt:"",body:"",cover_image:"",status:"draft",published_at:""}),f=C(()=>!!S.params.id),q=C(()=>f.value?"Perbarui Berita":"Tambah Berita Baru"),$=C(()=>f.value?"Perbarui Berita":"Simpan Berita");function T(){s.id=null,s.news_category_id="",s.title="",s.slug="",s.excerpt="",s.body="",s.cover_image="",s.status="draft",s.published_at=""}function M(){H.push({name:"admin.news"})}function z(){f.value?N():T()}async function D(){const e=(await v.get("/news-categories")).data;w.value=Array.isArray(e)?e:(e==null?void 0:e.data)??[]}async function N(){if(!f.value){T();return}m.value=!0;try{const{data:a}=await v.get(`/news/${S.params.id}`);s.id=a.id,s.news_category_id=a.news_category_id?String(a.news_category_id):"",s.title=a.title||"",s.slug=a.slug||"",s.excerpt=a.excerpt||"",s.body=a.body||"",s.cover_image=a.cover_image||"",s.status=a.status||"draft",s.published_at=a.published_at?a.published_at.substring(0,16):""}finally{m.value=!1}}async function P(){var e;const a=b.value.trim();if(!(!a||k.value)){k.value=!0,n.value="";try{const l=await v.post("/news-categories",{name:a}),o=((e=l==null?void 0:l.data)==null?void 0:e.data)??(l==null?void 0:l.data)??null;await D();const E=o!=null&&o.id?w.value.find(h=>h.id===o.id):w.value.find(h=>{var K;return((K=h.name)==null?void 0:K.toLowerCase())===a.toLowerCase()});E&&(s.news_category_id=String(E.id)),b.value="",n.value="Kategori berhasil ditambahkan."}catch(l){console.error(l),n.value="Gagal menambahkan kategori. Coba lagi."}finally{k.value=!1,g&&clearTimeout(g),n.value&&(g=setTimeout(()=>{n.value=""},3e3))}}}async function J(){if(!(c.value||m.value)){c.value=!0,_.value="";try{const a={news_category_id:s.news_category_id?Number(s.news_category_id):null,title:s.title,slug:s.slug||null,excerpt:s.excerpt||null,body:s.body,cover_image:s.cover_image||null,status:s.status,published_at:s.status==="published"&&s.published_at?s.published_at:null};f.value?await v.put(`/news/${s.id}`,a):await v.post("/news",a),M()}catch(a){console.error(a),_.value="Gagal menyimpan berita. Periksa koneksi atau lengkapi data wajib."}finally{c.value=!1}}}return Y(()=>s.status,a=>{if(a==="published"&&!s.published_at){const e=new Date;s.published_at=new Date(e.getTime()-e.getTimezoneOffset()*6e4).toISOString().slice(0,16)}}),Z(async()=>{await D(),await N()}),ee(()=>{g&&clearTimeout(g)}),(a,e)=>{const l=te("jodit-editor");return i(),r("div",ie,[t("header",re,[t("div",ne,[t("button",{class:"inline-flex items-center gap-2 text-xs font-semibold uppercase tracking-[0.35em] text-primary/70",onClick:M},[...e[9]||(e[9]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3.5 w-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M15 19l-7-7 7-7"})],-1),U(" Kembali ",-1)])]),t("h1",de,x(q.value),1),e[10]||(e[10]=t("p",{class:"text-sm text-slate-500"},"Lengkapi konten berita dan publikasikan ketika sudah siap.",-1))]),t("div",ue,[t("button",{class:"inline-flex items-center gap-2 rounded-full border border-slate-200 px-4 py-2 text-sm font-semibold text-slate-600 transition hover:border-primary hover:text-primary",type:"button",onClick:z}," Reset Form "),t("button",{class:"inline-flex items-center gap-2 rounded-full bg-primary px-5 py-2 text-sm font-semibold text-white shadow transition hover:bg-primary/90 disabled:cursor-not-allowed disabled:opacity-70",type:"button",onClick:J,disabled:c.value||m.value},[c.value?(i(),r("span",ce,[...e[11]||(e[11]=[t("svg",{class:"h-4 w-4 animate-spin",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M12 3v3m0 12v3m9-9h-3M6 12H3m15.364 6.364-2.121-2.121M8.757 8.757 6.636 6.636m12.728 0-2.121 2.121M8.757 15.243 6.636 17.364"})],-1),U(" Menyimpan... ",-1)])])):(i(),r("span",me,x($.value),1))],8,pe)])]),t("section",be,[_.value?(i(),r("p",ge,x(_.value),1)):j("",!0),t("form",{class:"grid gap-6 lg:grid-cols-[minmax(0,2fr)_1fr]",onSubmit:L(J,["prevent"])},[m.value?(i(),r("div",fe,[...e[12]||(e[12]=[t("div",{class:"h-10 w-10 animate-spin rounded-full border-4 border-primary/30 border-t-primary"},null,-1)])])):(i(),r(R,{key:1},[t("div",xe,[t("article",ye,[e[16]||(e[16]=t("h2",{class:"text-lg font-semibold text-slate-900"},"Informasi Utama",-1)),t("div",ve,[t("div",we,[e[13]||(e[13]=t("label",{class:"text-xs font-semibold text-slate-500"},"Judul berita",-1)),u(t("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>s.title=o),type:"text",class:"w-full rounded-lg border border-slate-200 px-3 py-2 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20",required:""},null,512),[[y,s.title]])]),t("div",_e,[e[14]||(e[14]=t("label",{class:"text-xs font-semibold text-slate-500"},"Slug (opsional)",-1)),u(t("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>s.slug=o),type:"text",class:"w-full rounded-lg border border-slate-200 px-3 py-2 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20",placeholder:"otomatis mengikuti judul"},null,512),[[y,s.slug]])]),t("div",ke,[e[15]||(e[15]=t("label",{class:"text-xs font-semibold text-slate-500"},"Ringkasan singkat",-1)),F(l,{jsUrl:p(V),cssUrl:p(B),modelValue:s.excerpt,"onUpdate:modelValue":e[2]||(e[2]=o=>s.excerpt=o),config:p(G)},null,8,["jsUrl","cssUrl","modelValue","config"])])])]),t("article",he,[e[17]||(e[17]=t("div",{class:"flex items-center justify-between"},[t("h2",{class:"text-lg font-semibold text-slate-900"},"Isi Berita"),t("span",{class:"text-xs uppercase tracking-[0.3em] text-slate-400"},"Jodit")],-1)),t("div",Ce,[F(l,{jsUrl:p(V),cssUrl:p(B),modelValue:s.body,"onUpdate:modelValue":e[3]||(e[3]=o=>s.body=o),config:p(A)},null,8,["jsUrl","cssUrl","modelValue","config"])])])]),t("div",Ue,[t("article",je,[e[25]||(e[25]=t("h2",{class:"text-lg font-semibold text-slate-900"},"Pengaturan Rilis",-1)),t("div",Ve,[t("div",Be,[e[20]||(e[20]=t("label",{class:"text-xs font-semibold text-slate-500"},"Kategori",-1)),u(t("select",{"onUpdate:modelValue":e[4]||(e[4]=o=>s.news_category_id=o),class:"w-full rounded-lg border border-slate-200 px-3 py-2 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20"},[e[18]||(e[18]=t("option",{value:""},"Tanpa kategori",-1)),(i(!0),r(R,null,se(w.value,o=>(i(),r("option",{key:o.id,value:o.id},x(o.name),9,Se))),128))],512),[[I,s.news_category_id]]),t("div",Te,[u(t("input",{"onUpdate:modelValue":e[5]||(e[5]=o=>b.value=o),type:"text",class:"min-w-[180px] flex-1 rounded-lg border border-dashed border-slate-300 px-3 py-2 text-xs focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20",placeholder:"Tambah kategori baru",onKeyup:oe(L(P,["prevent"]),["enter"])},null,40,Me),[[y,b.value]]),t("button",{type:"button",class:"inline-flex items-center gap-2 rounded-lg border border-primary/40 px-3 py-2 text-xs font-semibold text-primary transition hover:bg-primary hover:text-white disabled:cursor-not-allowed disabled:opacity-60",onClick:P,disabled:k.value||!b.value.trim()},[...e[19]||(e[19]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3.5 w-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M12 6v12m6-6H6"})],-1),U(" Simpan kategori ",-1)])],8,De)]),n.value?(i(),r("p",Ne,x(n.value),1)):j("",!0)]),t("div",Pe,[e[22]||(e[22]=t("label",{class:"text-xs font-semibold text-slate-500"},"Status",-1)),u(t("select",{"onUpdate:modelValue":e[6]||(e[6]=o=>s.status=o),class:"w-full rounded-lg border border-slate-200 px-3 py-2 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20"},[...e[21]||(e[21]=[t("option",{value:"draft"},"Draft",-1),t("option",{value:"published"},"Published",-1)])],512),[[I,s.status]])]),s.status==="published"?(i(),r("div",Je,[e[23]||(e[23]=t("label",{class:"text-xs font-semibold text-slate-500"},"Tanggal publikasi",-1)),u(t("input",{"onUpdate:modelValue":e[7]||(e[7]=o=>s.published_at=o),type:"datetime-local",class:"w-full rounded-lg border border-slate-200 px-3 py-2 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20"},null,512),[[y,s.published_at]])])):j("",!0),t("div",Ee,[e[24]||(e[24]=t("label",{class:"text-xs font-semibold text-slate-500"},"Gambar sampul (URL)",-1)),u(t("input",{"onUpdate:modelValue":e[8]||(e[8]=o=>s.cover_image=o),type:"text",class:"w-full rounded-lg border border-slate-200 px-3 py-2 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20",placeholder:"https://"},null,512),[[y,s.cover_image]])])])]),e[26]||(e[26]=t("article",{class:"rounded-2xl border border-slate-200 bg-white p-5 shadow-sm text-xs text-slate-500"},[t("h2",{class:"text-sm font-semibold text-slate-900"},"Tips Penulisan"),t("ul",{class:"mt-3 space-y-2 list-disc pl-4"},[t("li",null,"Pastikan judul singkat dan jelas."),t("li",null,"Sertakan ringkasan agar tampil rapi di kartu beranda."),t("li",null,"Gunakan gambar sampul beresolusi minimal 1200x675px.")])],-1))])],64)),e[27]||(e[27]=t("button",{type:"submit",class:"hidden"},"Simpan",-1))],32)])])}}};export{Ie as default};
