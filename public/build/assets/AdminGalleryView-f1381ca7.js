import{g as w,f as F,c as N,o as S,a as i,b as d,d as l,F as h,r as A,e as U,n as u,w as p,v as c,k as m,p as D,t as g}from"./app-7ddd2cfa.js";const H={class:"p-8"},M={class:"mt-8 grid gap-6 lg:grid-cols-[340px_1fr]"},O={class:"rounded-2xl border border-slate-200 bg-white p-4 shadow-sm"},T={class:"mt-4 space-y-2 text-sm"},K=["onClick"],L={class:"font-semibold"},J={class:"text-xs"},R={key:0,class:"text-xs text-slate-400"},q={key:0,class:"rounded-2xl border border-slate-200 bg-white p-6 shadow-sm"},z={class:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between"},E={class:"flex gap-2 text-xs font-semibold"},P={class:"mt-6 grid gap-4 md:grid-cols-2 text-sm"},Q={class:"text-xs font-semibold text-slate-500 space-y-1"},W={class:"text-xs font-semibold text-slate-500 space-y-1"},X={class:"md:col-span-2 text-xs font-semibold text-slate-500 space-y-1"},Y={class:"md:col-span-2 text-xs font-semibold text-slate-500 space-y-1"},Z={class:"mt-4 space-y-4"},ee={class:"grid gap-4 md:grid-cols-4 text-xs font-semibold text-slate-500"},te={class:"space-y-1 md:col-span-2"},le=["onUpdate:modelValue"],se={class:"space-y-1 md:col-span-2"},oe=["onUpdate:modelValue"],ae={class:"space-y-1 md:col-span-3"},ne=["onUpdate:modelValue"],ie={class:"space-y-1"},de=["onUpdate:modelValue"],re={class:"mt-3 flex justify-between text-xs font-semibold"},ue={class:"text-slate-400"},pe={class:"space-x-3"},ce=["onClick"],me=["onClick"],xe={key:0,class:"text-center text-xs text-slate-400"},be={key:1,class:"rounded-2xl border border-slate-200 bg-white p-10 text-center text-sm text-slate-500"},_e={__name:"AdminGalleryView",setup(ye){const r=w([]),o=F(null),n=w([]),V=N(()=>{var e;return((e=o.value)==null?void 0:e._key)??null});function _(e){return`${e}-${Math.random().toString(36).slice(2,9)}`}function x(e={},t=[]){return{_key:_(e.id??"new"),id:e.id??null,title:e.title??"",slug:e.slug??"",description:e.description??"",cover_image:e.cover_image??"",items:e.items??t??[]}}function b(e={}){var t;return{_key:_(e.id??"new"),id:e.id??null,gallery_album_id:e.gallery_album_id??((t=o.value)==null?void 0:t.id)??null,title:e.title??"",caption:e.caption??"",image_url:e.image_url??"",order:Number(e.order??0)}}function C(e){var t;return{id:e.id??null,gallery_album_id:((t=o.value)==null?void 0:t.id)??e.gallery_album_id??null,title:e.title??"",caption:e.caption??"",image_url:e.image_url??"",order:Number(e.order??0)}}function y(){o.value&&(o.value.items=n.map(e=>C(e)))}async function v(){const{data:e}=await m.get("/gallery-albums");if(r.splice(0,r.length,...e.map(t=>x(t,t.items??[]))),o.value){const t=r.find(s=>s.id===o.value.id);t?f(t):(o.value=null,n.splice(0,n.length))}}function $(){const e=x();r.unshift(e),f(e)}function f(e){o.value=e,n.splice(0,n.length,...(e.items??[]).map(b))}async function k(e){const t={title:e.title,slug:e.slug||null,description:e.description||null,cover_image:e.cover_image||null};if(e.id){const{data:s}=await m.put(`/gallery-albums/${e.id}`,t);Object.assign(e,x({...s,items:e.items}))}else{const{data:s}=await m.post("/gallery-albums",t);Object.assign(e,x({...s,items:[]}))}y(),e.id||f(e)}async function j(e){var s;if(e.id){if(!confirm(`Hapus album "${e.title||"album"}"?`))return;await m.delete(`/gallery-albums/${e.id}`)}const t=r.findIndex(a=>a._key===e._key);t!==-1&&r.splice(t,1),((s=o.value)==null?void 0:s._key)===e._key&&(o.value=null,n.splice(0,n.length))}function I(){const e=b();n.unshift(e),y()}async function B(e){var s;(s=o.value)!=null&&s.id||await k(o.value);const t={gallery_album_id:o.value.id,title:e.title||null,caption:e.caption||null,image_url:e.image_url,order:Number(e.order)||0};if(e.id){const{data:a}=await m.put(`/gallery-items/${e.id}`,t);Object.assign(e,b({...a}))}else{const{data:a}=await m.post("/gallery-items",t);Object.assign(e,b({...a}))}y()}async function G(e){if(e.id){if(!confirm("Hapus foto ini?"))return;await m.delete(`/gallery-items/${e.id}`)}const t=n.findIndex(s=>s._key===e._key);t!==-1&&n.splice(t,1),y()}return S(v),(e,t)=>(i(),d("div",H,[l("header",{class:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between"},[t[6]||(t[6]=l("div",null,[l("h1",{class:"text-2xl font-semibold text-slate-900"},"Galeri Desa"),l("p",{class:"text-sm text-slate-500"},"Kelola album galeri dan foto dokumentasi kegiatan.")],-1)),l("div",{class:"flex gap-3 text-sm font-semibold"},[l("button",{class:"inline-flex items-center gap-2 rounded-full border border-slate-200 px-4 py-2 text-slate-600",onClick:v}," Muat Ulang "),l("button",{class:"inline-flex items-center gap-2 rounded-full bg-primary px-4 py-2 text-white",onClick:$}," Album Baru ")])]),l("section",M,[l("aside",O,[t[7]||(t[7]=l("h2",{class:"text-sm font-semibold text-slate-700"},"Album",-1)),l("ul",T,[(i(!0),d(h,null,A(r,s=>{var a;return i(),d("li",{key:s._key,class:D(["cursor-pointer rounded-lg border px-3 py-2 transition",s._key===V.value?"border-primary bg-primary/10 text-primary":"border-slate-200 text-slate-600 hover:border-primary/40"]),onClick:fe=>f(s)},[l("p",L,g(s.title||"Album Baru"),1),l("p",J,g(((a=s.items)==null?void 0:a.length)??0)+" foto",1)],10,K)}),128))]),r.length?U("",!0):(i(),d("p",R,"Belum ada album. Tambahkan album baru untuk memulai."))]),o.value?(i(),d("div",q,[l("div",z,[t[8]||(t[8]=l("h2",{class:"text-lg font-semibold text-slate-900"},"Detail Album",-1)),l("div",E,[l("button",{class:"rounded-full border border-slate-200 px-4 py-1 text-slate-600",onClick:t[0]||(t[0]=s=>k(o.value))}," Simpan Album "),l("button",{class:"rounded-full border border-rose-200 px-4 py-1 text-rose-500",onClick:t[1]||(t[1]=s=>j(o.value))}," Hapus Album ")])]),l("div",P,[l("label",Q,[t[9]||(t[9]=u(" Judul Album ",-1)),p(l("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>o.value.title=s),type:"text",class:"w-full rounded-lg border border-slate-200 px-3 py-2"},null,512),[[c,o.value.title]])]),l("label",W,[t[10]||(t[10]=u(" Slug (opsional) ",-1)),p(l("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>o.value.slug=s),type:"text",class:"w-full rounded-lg border border-slate-200 px-3 py-2",placeholder:"otomatis dari judul"},null,512),[[c,o.value.slug]])]),l("label",X,[t[11]||(t[11]=u(" Deskripsi ",-1)),p(l("textarea",{"onUpdate:modelValue":t[4]||(t[4]=s=>o.value.description=s),rows:"3",class:"w-full rounded-lg border border-slate-200 px-3 py-2"},null,512),[[c,o.value.description]])]),l("label",Y,[t[12]||(t[12]=u(" Gambar Sampul (URL) ",-1)),p(l("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>o.value.cover_image=s),type:"text",class:"w-full rounded-lg border border-slate-200 px-3 py-2"},null,512),[[c,o.value.cover_image]])])]),l("div",{class:"mt-10 flex items-center justify-between"},[t[13]||(t[13]=l("h3",{class:"text-md font-semibold text-slate-900"},"Foto dalam Album",-1)),l("button",{class:"text-xs font-semibold text-primary",onClick:I},"Tambah Foto")]),l("div",Z,[(i(!0),d(h,null,A(n,s=>(i(),d("article",{key:s._key,class:"rounded-xl border border-slate-100 bg-slate-50 p-4"},[l("div",ee,[l("label",te,[t[14]||(t[14]=u(" Judul ",-1)),p(l("input",{"onUpdate:modelValue":a=>s.title=a,type:"text",class:"w-full rounded-lg border border-slate-200 px-3 py-2 text-sm"},null,8,le),[[c,s.title]])]),l("label",se,[t[15]||(t[15]=u(" Caption ",-1)),p(l("input",{"onUpdate:modelValue":a=>s.caption=a,type:"text",class:"w-full rounded-lg border border-slate-200 px-3 py-2 text-sm"},null,8,oe),[[c,s.caption]])]),l("label",ae,[t[16]||(t[16]=u(" URL Gambar ",-1)),p(l("input",{"onUpdate:modelValue":a=>s.image_url=a,type:"text",class:"w-full rounded-lg border border-slate-200 px-3 py-2 text-sm"},null,8,ne),[[c,s.image_url]])]),l("label",ie,[t[17]||(t[17]=u(" Urutan ",-1)),p(l("input",{"onUpdate:modelValue":a=>s.order=a,type:"number",min:"0",class:"w-full rounded-lg border border-slate-200 px-3 py-2 text-sm"},null,8,de),[[c,s.order,void 0,{number:!0}]])])]),l("div",re,[l("span",ue,g(s.id?"Foto tersimpan":"Foto baru"),1),l("div",pe,[l("button",{class:"text-primary",onClick:a=>B(s)},"Simpan",8,ce),l("button",{class:"text-rose-500",onClick:a=>G(s)},"Hapus",8,me)])])]))),128)),n.length?U("",!0):(i(),d("p",xe,"Belum ada foto pada album ini."))])])):(i(),d("div",be," Pilih album untuk melihat detail. "))])]))}};export{_e as default};
